<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>System Wyników Sejmowych</title>
    <style>
        body { 
            background: #f0f0f0; 
            color: #000; 
            font-family: "Times New Roman", Times, serif; 
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .sejm-board {
            background: white;
            width: 80%;
            max-width: 900px;
            padding: 50px;
            border: 15px solid #1a1a1a; /* Ramka monitora */
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }
        .header {
            font-size: 2.5rem;
            text-align: center;
            font-weight: bold;
            text-transform: uppercase;
            margin-bottom: 60px;
            letter-spacing: 2px;
        }
        .row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 35px 0;
            font-size: 3.5rem; /* Bardzo duży tekst */
            font-weight: bold;
            text-transform: uppercase;
        }
        .total-row {
            border-bottom: 4px solid #000;
            margin-bottom: 80px;
            padding-bottom: 10px;
        }
        .label { flex: 1; }
        .val { width: 250px; text-align: right; }
        
        /* Ukrywamy paski postępu, bo na zdjęciu ich nie ma */
        .bar-container { display: none; }
    </style>
</head>
<body>
    <div class="sejm-board">
        <div class="header" id="title">GŁOSOWANIE</div>
        
        <div class="row total-row">
            <div class="label">GŁOSOWAŁO</div>
            <div class="val" id="total">0</div>
        </div>

        <div id="results">
            </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

        const firebaseConfig = { 
            apiKey: "AIzaSyBo7bSndks_GClZBvnDMIsdVRWw5oCWiRM",
            authDomain: "votelive-f469d.firebaseapp.com",
            projectId: "votelive-f469d",
            storageBucket: "votelive-f469d.firebasestorage.app",
            messagingSenderId: "959356764271",
            appId: "1:959356764271:web:76f0284a0a1ce6e9874d9a" 
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        onSnapshot(doc(db, "ankiet", "vote"), (snap) => {
            const data = snap.data();
            if(!data) return;
            
            // Ustawiamy tytuł (np. GŁOSOWANIE NR 134)
            document.getElementById('title').innerText = data.tytul.toUpperCase();
            
            const resDiv = document.getElementById('results');
            resDiv.innerHTML = "";
            
            const wynikiEntries = Object.entries(data.wyniki || {});
            let total = Object.values(data.wyniki || {}).reduce((a, b) => a + b, 0);
            
            document.getElementById('total').innerText = total;

            // Sortujemy tak, aby ZA było na górze, potem PRZECIW, potem reszta
            wynikiEntries.sort((a, b) => {
                const order = ["ZA", "PRZECIW", "WSTRZYM"];
                let indexA = order.findIndex(label => a[0].toUpperCase().includes(label));
                let indexB = order.findIndex(label => b[0].toUpperCase().includes(label));
                return (indexA === -1 ? 99 : indexA) - (indexB === -1 ? 99 : indexB);
            });

            wynikiEntries.forEach(([key, val]) => {
                let displayKey = key.toUpperCase();
                // Poprawka dla "WSTRZYMUJE SIĘ" aby wyglądało jak w Sejmie
                if(displayKey.includes("WSTRZYM")) displayKey = "WSTRZYMAŁO SIĘ";

                resDiv.innerHTML += `
                    <div class="row">
                        <div class="label">${displayKey}</div>
                        <div class="val">${val}</div>
                    </div>`;
            });
        });
    </script>
</body>
</html>
