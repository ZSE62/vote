<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Tablica Wyników</title>
    <style>
        body { font-family: sans-serif; background: #2c3e50; color: white; text-align: center; padding: 50px; }
        h1 { font-size: 3.5rem; margin-bottom: 60px; }
        .results-grid { display: flex; justify-content: center; gap: 60px; }
        .res-box { padding: 20px; min-width: 200px; border-radius: 10px; background: rgba(255,255,255,0.05); }
        .label { font-size: 1.8rem; margin-bottom: 20px; font-weight: bold; }
        .value { font-size: 5rem; font-weight: bold; }
        .za { color: #2ecc71; }
        .przeciw { color: #e74c3c; }
        .wstrzymuje { color: #f1c40f; }
        .footer { margin-top: 100px; font-size: 1.5rem; opacity: 0.6; }
    </style>
</head>
<body>
    <h1 id="title">Oczekiwanie na głosowanie...</h1>
    <div class="results-grid" id="grid"></div>
    <div class="footer" id="stats">Obecnych: 0 | Głosowało: 0</div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

        const firebaseConfig = { 
            apiKey: "AIzaSyBo7bSndks_GClZBvnDMIsdVRWw5oCWiRM",
            authDomain: "votelive-f469d.firebaseapp.com",
            projectId: "votelive-f469d",
            storageBucket: "votelive-f469d.firebasestorage.app",
            messagingSenderId: "959356764271",
            appId: "1:959356764271:web:76f0284a0a1ce6e9874d9a" 
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const docRef = doc(db, "ankiet", "vote");

        onSnapshot(docRef, (snap) => {
            const data = snap.data(); if(!data) return;
            document.getElementById('title').innerText = data.tytul;
            
            let keys = Object.keys(data.wyniki || {});
            if (keys.includes("ZA")) keys = ["ZA", "PRZECIW", "WSTRZYMAŁO SIĘ"].filter(k => keys.includes(k));
            else keys.sort();

            const grid = document.getElementById('grid');
            grid.innerHTML = "";
            let total = 0;

            keys.forEach(key => {
                const val = data.wyniki[key];
                total += val;
                let c = "za";
                if(key === "PRZECIW") c = "przeciw";
                if(key === "WSTRZYMAŁO SIĘ") c = "wstrzymuje";

                grid.innerHTML += `
                    <div class="res-box">
                        <div class="label">${key}</div>
                        <div class="value ${c}">${val}</div>
                    </div>
                `;
            });
            document.getElementById('stats').innerText = `Obecnych: ${data.obecni?.length || 0} | Głosowało: ${total}`;
        });
    </script>
</body>
</html>
